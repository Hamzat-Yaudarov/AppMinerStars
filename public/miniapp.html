<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MineStars</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/public/miniapp.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="app-header">MineStars</header>
      <nav class="tab-bar">
        <button class="tab-btn" data-tab="profile">Профиль</button>
        <button class="tab-btn" data-tab="mine">Шахта</button>
        <button class="tab-btn" data-tab="shop">Магазин</button>
        <button class="tab-btn" data-tab="games">Игры</button>
      </nav>
      <main class="tab-content">
        <section id="tab-profile" class="tab-panel active">
          <div class="profile-grid">
            <div class="profile-row"><span class="label">Ник:</span><span id="username" class="value"></span></div>
            <div class="profile-row"><span class="label">ИД:</span><span id="userId" class="value"></span></div>
            <div class="profile-row"><span class="label">Ур. кирки:</span><span id="pickaxeLevel" class="value"></span></div>
            <div class="profile-row"><span class="label">Звёзды:</span><span id="stars" class="value"></span></div>
            <div class="profile-row"><span class="label">MCoin:</span><span id="mcoin" class="value"></span></div>
          </div>
          <div class="quick-actions">
            <button id="exchangeOpen" class="secondary-btn">Обменник</button>
            <button id="sellOpen" class="secondary-btn">Продать</button>
            <button id="nftToggle" class="secondary-btn">NFT</button>
            <button id="topupOpen" class="secondary-btn">Пополнить</button>
            <button id="withdrawOpen" class="secondary-btn">Вывод</button>
          </div>
          <div class="resources">
            <div class="res-row"><span class="label">Уголь:</span><span id="coal" class="value"></span></div>
            <div class="res-row"><span class="label">Медь:</span><span id="copper" class="value"></span></div>
            <div class="res-row"><span class="label">Железо:</span><span id="iron" class="value"></span></div>
            <div class="res-row"><span class="label">Золото:</span><span id="gold" class="value"></span></div>
            <div class="res-row"><span class="label">Алмаз:</span><span id="diamond" class="value"></span></div>
          </div>
          <div id="nftList" class="nft-list" style="display:none"></div>
        </section>
        <section id="tab-mine" class="tab-panel">
          <div class="mine-panel">
            <p class="mine-note">Копать можно раз в 3 часа. Добыча ограничена MC-лимитом уровня.</p>
            <button id="mineBtn" class="primary-btn">Копать</button>
            <div id="cooldownText" class="hint-text"></div>
            <pre id="mineResult" class="result-box"></pre>
          </div>
        </section>
        <section id="tab-shop" class="tab-panel">
          <div class="shop-cases">
            <div class="case-card">
              <div class="case-title">Кейс ⭐ 100</div>
              <div class="case-desc">25★ (10%), 50★ (25%), 75★ (30%), 150★ (30%), 300★ (5%)</div>
              <button class="primary-btn" data-case="1">Открыть</button>
            </div>
            <div class="case-card">
              <div class="case-title">Кейс ⭐ 700</div>
              <div class="case-desc">Snoop Dogg (66%), Swag Bag (30%), Snoop Cigar (5%), Low Rider (1%)</div>
              <button class="primary-btn" data-case="2">Открыть</button>
            </div>
          </div>
          <div id="shopMsg" class="hint-text"></div>
          <div class="shop-panel">
            <button id="upgradeBtn" class="primary-btn">Купить/улучшить кирку</button>
            <div class="shop-row"><span class="label">Текущий уровень кирки:</span><span id="shopPickaxe" class="value"></span></div>
            <div class="shop-row"><span class="label">Цена следующего уровня:</span><span id="nextCost" class="value"></span></div>
          </div>
        </section>
        <section id="tab-games" class="tab-panel">
          <div class="games-panel">
            <div id="gamesStepSelect" class="games-step">
              <div class="section-title">Выберите игру</div>
              <div class="shop-cases">
                <div class="case-card">
                  <div class="case-title">Лесенка</div>
                  <div class="case-desc">Пройди 7 уровней и умножь ставку</div>
                  <button id="chooseLesenka" class="primary-btn">Выбрать</button>
                </div>
              </div>
            </div>

            <div id="gamesStepStake" class="games-step hidden">
              <div class="section-title">Выберите ставку</div>
              <div class="stake-grid">
                <button class="secondary-btn stake" data-v="10">10★</button>
                <button class="secondary-btn stake" data-v="15">15★</button>
                <button class="secondary-btn stake" data-v="25">25★</button>
                <button class="secondary-btn stake" data-v="50">50★</button>
                <button class="secondary-btn stake" data-v="150">150★</button>
                <button class="secondary-btn stake" data-v="250">250★</button>
                <button class="secondary-btn stake" data-v="300">300★</button>
                <button class="secondary-btn stake" data-v="400">400★</button>
                <button class="secondary-btn stake" data-v="500">500★</button>
              </div>
              <div class="shop-row"><span class="label">Игра:</span><span id="chosenGame" class="value">—</span></div>
              <div class="shop-row"><span class="label">Ставка:</span><span id="chosenStake" class="value">—</span></div>
              <div style="display:flex;gap:10px;align-items:center">
                <button id="gameStartBtn" class="primary-btn">Начать</button>
                <button id="gameBackBtn" class="secondary-btn">Вернуться</button>
              </div>
              <div id="gamesStakeMsg" class="hint-text"></div>
            </div>

            <div id="gamesStepPlay" class="games-step hidden">
              <div class="section-title">Лесенка</div>
              <div>
                <button id="lesenkaCashout" class="secondary-btn">Забрать</button>
                <button id="gamesReturnToSelect" class="secondary-btn">Игры</button>
              </div>
              <div class="shop-row"><span class="label">Текущий уровень:</span><span id="lesenkaLevel" class="value">—</span></div>
              <div class="ladder-grid" id="ladderGrid"></div>
              <div id="lesenkaMsg" class="hint-text"></div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div id="modal" class="modal" style="display:none">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-actions"><button id="modalClose" class="secondary-btn">За��рыть</button></div>
      </div>
    </div>

    <script src="/public/miniapp.js"></script>
  </body>
</html>
